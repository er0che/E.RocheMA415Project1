install.packages("rlang")
knitr::opts_chunk$set(echo = FALSE)
#Please use install.packages("gridExtra") for this presentation
#load libraries
library(tidyverse)
library(grid)
library(gridExtra)
library(knitr)
#input data
fridge <- read_csv("https://www.eia.gov/consumption/residential/data/2015/csv/recs2015_public_v1.csv") %>%
select(KOWNRENT, NUMFRIG, SIZRFRI1, TYPERFR1, AGERFRI1, ICE, SIZRFRI2, AGERFRI2, LOCRFRI2, NUMFREEZ, NUMMEAL, REBATEAPP, RECYCAPP, TAXCREDITAPP, ESFREEZE, ESFRIG, EMPLOYHH, ATHOME, MONEYPY, DIVISION, UATYP10)
#clean the fridge data
fridge$AGERFRI1 <- apply(as.matrix(fridge[,5]), MARGIN = 2, function(x) {ifelse(x == -2, NA, x)})
fridge$AGERFRI1 <- apply(fridge[,5], MARGIN = 2, function(x) {ifelse(x == 5, 20, x)})
fridge$AGERFRI1 <- apply(fridge$AGERFRI1, MARGIN = 2, function(x) {ifelse(x == 42, 17, x)})
fridge$AGERFRI1 <- apply(fridge$AGERFRI1, MARGIN = 2, function(x) {ifelse(x == 41, 12, x)})
fridge$AGERFRI1 <- apply(fridge$AGERFRI1, MARGIN = 2, function(x) {ifelse(x == 3, 7, x)})
fridge$AGERFRI1 <- apply(fridge$AGERFRI1, MARGIN = 2, function(x) {ifelse(x == 2, 3, x)})
fridge$TYPERFR1 <- apply(fridge[,4], MARGIN = 2, function(x){ifelse(x == -2, NA, x)})
fridge$TYPERFR1 <- apply(fridge[,4], MARGIN = 2, function(x){ifelse(x == 21 | x == 22 | x == 23, 2, x)})
fridge$TYPERFR1 <- apply(fridge[,4], MARGIN = 2, function(x){ifelse(x == 5, 3, x)})
fridge$ICE <- apply(fridge[,6], MARGIN = 2, function(x){ifelse(x == -2, NA, x)})
fridge$ICE <- apply(fridge[,6], MARGIN = 2, function(x){ifelse(x == 1, "Ice", x)})
fridge$ICE <- apply(fridge[,6], MARGIN = 2, function(x){ifelse(x == 0, "No Ice", x)})
fridge$KOWNRENT <- apply(fridge[,1], MARGIN = 2, function(x){ifelse(x == 1, "Owned", x)})
fridge$KOWNRENT <- apply(fridge[,1], MARGIN = 2, function(x){ifelse(x == 2, "Rented", x)})
fridge$KOWNRENT <- apply(fridge[,1], MARGIN = 2, function(x){ifelse(x == 3, "Other", x)})
fridge$SIZRFRI1 <- apply(fridge[,3], MARGIN = 2, function(x){ifelse(x == -2, NA, x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == -2, NA, x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 1, "Basement", x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 2, "Garage", x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 3, "Outside", x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 4, "Main Floor", x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 9, "Other", x)})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 1, 21, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 2, 14, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 3, 7, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 4, 3.5, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 5, 1, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 6, 0.5, x )})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 1, "New England", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 2, "Mid Atlantic", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 3, "East North Central", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 4, "West North Central", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 5, "South Atlantic", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 6, "East South Central", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 7, "West South Central", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 8, "Mountain North", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 9, "Mountain South", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 10, "Pacific", x)})
rebate1 <- filter(fridge, REBATEAPP > -1)
#clean the fridge data
fridge$AGERFRI1 <- apply(as.matrix(fridge[,5]), MARGIN = 2, function(x) {ifelse(x == -2, NA, x)})
fridge$AGERFRI1 <- apply(fridge[,5], MARGIN = 2, function(x) {ifelse(x == 5, 20, x)})
fridge$AGERFRI1 <- apply(fridge$AGERFRI1, MARGIN = 2, function(x) {ifelse(x == 42, 17, x)})
fridge$AGERFRI1 <- apply(fridge$AGERFRI1, MARGIN = 2, function(x) {ifelse(x == 41, 12, x)})
fridge$AGERFRI1 <- apply(fridge$AGERFRI1, MARGIN = 2, function(x) {ifelse(x == 3, 7, x)})
fridge$AGERFRI1 <- apply(fridge$AGERFRI1, MARGIN = 2, function(x) {ifelse(x == 2, 3, x)})
fridge$TYPERFR1 <- apply(fridge[,4], MARGIN = 2, function(x){ifelse(x == -2, NA, x)})
fridge$TYPERFR1 <- apply(fridge[,4], MARGIN = 2, function(x){ifelse(x == 21 | x == 22 | x == 23, 2, x)})
fridge$TYPERFR1 <- apply(fridge[,4], MARGIN = 2, function(x){ifelse(x == 5, 3, x)})
fridge$ICE <- apply(fridge[,6], MARGIN = 2, function(x){ifelse(x == -2, NA, x)})
fridge$ICE <- apply(fridge[,6], MARGIN = 2, function(x){ifelse(x == 1, "Ice", x)})
fridge$ICE <- apply(fridge[,6], MARGIN = 2, function(x){ifelse(x == 0, "No Ice", x)})
fridge$KOWNRENT <- apply(fridge[,1], MARGIN = 2, function(x){ifelse(x == 1, "Owned", x)})
fridge$KOWNRENT <- apply(fridge[,1], MARGIN = 2, function(x){ifelse(x == 2, "Rented", x)})
fridge$KOWNRENT <- apply(fridge[,1], MARGIN = 2, function(x){ifelse(x == 3, "Other", x)})
fridge$SIZRFRI1 <- apply(fridge[,3], MARGIN = 2, function(x){ifelse(x == -2, NA, x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == -2, NA, x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 1, "Basement", x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 2, "Garage", x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 3, "Outside", x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 4, "Main Floor", x)})
fridge$LOCRFRI2 <- apply(fridge[,9], MARGIN = 2, function(x){ifelse(x == 9, "Other", x)})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 1, 21, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 2, 14, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 3, 7, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 4, 3.5, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 5, 1, x )})
fridge$NUMMEAL <- apply(fridge[,11], MARGIN = 2, function(x) {ifelse(x == 6, 0.5, x )})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 1, "New England", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 2, "Mid Atlantic", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 3, "East North Central", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 4, "West North Central", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 5, "South Atlantic", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 6, "East South Central", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 7, "West South Central", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 8, "Mountain North", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 9, "Mountain South", x)})
fridge$DIVISION <- apply(fridge[,20], MARGIN = 2, function(x){ifelse(x == 10, "Pacific", x)})
rebate1 <- dplyr::filter(fridge, REBATEAPP > -1)
